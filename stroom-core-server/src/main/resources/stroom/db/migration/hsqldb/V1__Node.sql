/*
 * Copyright 2016 Crown Copyright
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

----------------------------------------
-- General
----------------------------------------

-- Folder
create table FOLDER (ID INT generated by default as identity (start with 1), VER TINYINT not null, CRT_DT TIMESTAMP not null, CRT_USER varchar(255), UPD_DT TIMESTAMP not null, UPD_USER varchar(255), NAME varchar(255) not null, UUID varchar(255) not null, FK_FOLDER_ID INT, primary key (ID));
alter table FOLDER add constraint UK_FK_FOLDER_ID_NAME unique (FK_FOLDER_ID, NAME);
alter table FOLDER add constraint UK_FOLDER_UUID unique (UUID);
alter table FOLDER add constraint FK_FOLDER_FK_FOLDER_ID foreign key (FK_FOLDER_ID) references FOLDER;

-- Global Properties
create table GLOB_PROP (ID INT generated by default as identity (start with 1), VER TINYINT not null, CRT_DT TIMESTAMP not null, CRT_USER varchar(255), UPD_DT TIMESTAMP not null, UPD_USER varchar(255), NAME varchar(255) not null, VAL clob(2147483647) not null, primary key (ID));
alter table GLOB_PROP add constraint UK_2834dq95j36gwd8xrddga388w  unique (NAME);

-- Cluster Lock
create table CLSTR_LK (ID INT generated by default as identity (start with 1), VER TINYINT not null, NAME varchar(255) not null, primary key (ID));
alter table CLSTR_LK add constraint UK_eta9xslwk7jo39il7ohr38qds  unique (NAME);



----------------------------------------
-- Node
----------------------------------------

-- Rack
create table RK (ID INT generated by default as identity (start with 1), VER TINYINT not null, CRT_DT TIMESTAMP not null, CRT_USER varchar(255), UPD_DT TIMESTAMP not null, UPD_USER varchar(255), NAME varchar(255) not null, primary key (ID));
alter table RK add constraint UK_s0v0ew63mw0oejctws0q25dm7  unique (NAME);

-- Node
create table ND (ID INT generated by default as identity (start with 1), VER TINYINT not null, CRT_DT TIMESTAMP not null, CRT_USER varchar(255), UPD_DT TIMESTAMP not null, UPD_USER varchar(255), NAME varchar(255) not null, CLSTR_URL varchar(255), ENBL boolean not null, PRIOR SMALLINT not null, FK_RK_ID INT not null, primary key (ID));
alter table ND add constraint UK_2ti4g48mpwg1srr3io9xpaqq  unique (NAME);
alter table ND add constraint FK_jn3j89fvspo7cv7ucq4ys5qd5 foreign key (FK_RK_ID) references RK;