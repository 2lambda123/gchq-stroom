ext.moduleName = 'stroom.integrationtest'

dependencies {
    integrationTestImplementation project(':stroom-app')
    // Use default DB config.
    integrationTestImplementation project(':stroom-config:stroom-config-app')
    integrationTestImplementation project(':stroom-core-server')
    integrationTestImplementation project(':stroom-core-shared')
    integrationTestImplementation project(':stroom-docstore:stroom-docstore-impl')
    integrationTestImplementation project(':stroom-docstore:stroom-docstore-shared')
    integrationTestImplementation project(':stroom-dashboard:stroom-dashboard-server')
    integrationTestImplementation project(':stroom-dashboard:stroom-dashboard-shared')
    integrationTestImplementation project(':stroom-data-meta:stroom-data-meta-api')
    integrationTestImplementation project(':stroom-data-meta:stroom-data-meta-impl-db')
    integrationTestImplementation project(':stroom-data-meta:stroom-data-meta-impl-mock')
    integrationTestImplementation project(':stroom-data-store:stroom-data-store-api')
    integrationTestImplementation project(':stroom-data-store:stroom-data-store-impl-fs')
    integrationTestImplementation project(':stroom-data-store:stroom-data-store-impl-mock')
    integrationTestImplementation project(':stroom-elastic:stroom-elastic-impl')
    integrationTestImplementation project(':stroom-entity-shared')
    integrationTestImplementation project(':stroom-explorer:stroom-explorer-api')
    integrationTestImplementation project(':stroom-explorer:stroom-explorer-impl')
    integrationTestImplementation project(':stroom-explorer:stroom-explorer-impl-db')
    integrationTestImplementation project(':stroom-headless')
    integrationTestImplementation project(':stroom-importexport:stroom-importexport-api')
    integrationTestImplementation project(':stroom-index:stroom-index-server')
    integrationTestImplementation project(':stroom-index:stroom-index-shared')
    integrationTestImplementation project(':stroom-pipeline')
    integrationTestImplementation project(':stroom-ruleset:stroom-ruleset-server')
    integrationTestImplementation project(':stroom-security:stroom-security-api')
    integrationTestImplementation project(':stroom-security:stroom-security-impl-mock')
    integrationTestImplementation project(':stroom-security:stroom-security-server')
    integrationTestImplementation project(':stroom-security:stroom-security-shared')
    integrationTestImplementation project(':stroom-statistics:stroom-statistics-api')
    integrationTestImplementation project(':stroom-statistics:stroom-statistics-server')
    integrationTestImplementation project(':stroom-statistics:stroom-statistics-shared')
    integrationTestImplementation project(':stroom-task:stroom-task-api')
    integrationTestImplementation project(':stroom-test-common')
    integrationTestImplementation project(':stroom-util')
    integrationTestImplementation project(':stroom-util-shared')

//    integrationTestImplementation project(path: ':stroom-core-server', configuration: 'testArtifacts')
//    integrationTestImplementation project(path: ':stroom-dashboard:stroom-dashboard-server', configuration: 'testArtifacts')
//    integrationTestImplementation project(path: ':stroom-index:stroom-index-server', configuration: 'testArtifacts')
//    integrationTestImplementation project(path: ':stroom-pipeline', configuration: 'testArtifacts')
//    integrationTestImplementation project(path: ':stroom-security:stroom-security-server', configuration: 'testArtifacts')
    integrationTestImplementation project(':stroom-test-common')

    integrationTestImplementation libs.stroomQueryApi
    integrationTestImplementation libs.stroomQueryCommon

<<<<<<< HEAD
    integrationTestCompile libs.slf4j_api
    integrationTestCompile libs.junit_jupiter_api
    integrationTestCompile libs.fast_classpath_scanner
=======
    integrationTestImplementation libs.commons_io
    integrationTestImplementation libs.fast_classpath_scanner
    integrationTestImplementation libs.guice4
    integrationTestImplementation libs.hibernate_core
    integrationTestImplementation libs.hibernate_jpa_api
    integrationTestImplementation libs.hikari
    integrationTestCompileOnly libs.junit_jupiter_api
    integrationTestImplementation libs.lucene_core
    integrationTestImplementation libs.saxon_he
    integrationTestImplementation libs.slf4j_api
    integrationTestImplementation libs.vavr
>>>>>>> 5b0214875b1d88052537b028e33f9855813fd650

    integrationTestRuntimeOnly libs.javax_el
    //the following logging libs are needed when running junits outside dropwizard
    integrationTestRuntimeOnly libs.jcl_over_slf4j
    integrationTestRuntimeOnly libs.jul_to_slf4j
    integrationTestRuntimeOnly libs.log4j_over_slf4j
    integrationTestRuntimeOnly libs.logback_classic
    integrationTestRuntimeOnly libs.logback_core
    integrationTestRuntimeOnly libs.jaxb_runtime
    integrationTestRuntimeOnly libs.javax_activation

    integrationTestImplementation libs.mockito_core
    integrationTestImplementation libs.assertj_core
    integrationTestImplementation libs.dropwizard_testing
    integrationTestImplementation libs.dropwizard_client

    // The following logging libs are needed when running junits outside dropwizard
    integrationTestRuntimeOnly libs.javax_activation
    integrationTestRuntimeOnly libs.jaxb_runtime
    integrationTestRuntimeOnly libs.jcl_over_slf4j
    integrationTestRuntimeOnly libs.jul_to_slf4j
    integrationTestRuntimeOnly libs.junit_jupiter_engine
    integrationTestRuntimeOnly libs.log4j_over_slf4j
    integrationTestRuntimeOnly libs.logback_classic
    integrationTestRuntimeOnly libs.logback_core
}

task setupSampleDataApplication(type: JavaExec) {
    dependsOn this:compileJava
    dependsOn this:compileTestJava
    // We need to set the working directory as the stroom root otherwise
    // setupSampleData won't find 'samples' directories in other modules.
    workingDir '../'
    classpath = sourceSets.integrationTest.runtimeClasspath
    main = 'stroom.test.SetupSampleData'
}

////TODO This specific dep is needed to ensure TestKafkaExternalLoader has the jar available
////for its test. This is a TODO as stroom-connectors needs a big refactor once we
////decide what we are doing with plugable client libs and pipeline elements.
//tasks.integrationTest.dependsOn ':stroom-kafka:stroom-kafka-client-impl_0_10_0_1:copyPluginJar'
