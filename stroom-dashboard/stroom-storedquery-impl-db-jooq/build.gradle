ext.moduleName = 'stroom.storedquery.impl.db.jooq'

// Declare a source set just for our GWT compile that is separate from the Java compilation source set.
sourceSets {
    jooqCodeGen
}

dependencies {
    jooqCodeGenImplementation project(':stroom-jooq-codegen')

    implementation libs.jakarta_annotation_api
    implementation libs.jooq
}

def genJooqSourceDirs = []
// Add all of the library sources from the gwtSource source set defined above.
genJooqSourceDirs.addAll(sourceSets.jooqCodeGen.runtimeClasspath)
genJooqSourceDirs.addAll(sourceSets.main.resources.srcDirs)

task genJooq(type: JavaExec) {
    dependsOn ':stroom-jooq-codegen:build'
    classpath {
        genJooqSourceDirs
    }
    mainClass = "stroom.jooq.codegen.JooqGenerator"
    args = [
            '-schema', 'stored_query',
            '-flywayLocations', 'stroom/storedquery/impl/db/migration',
            '-flywayTable', 'query_schema_history'
    ]
}
