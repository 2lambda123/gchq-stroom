#!/usr/bin/env bash
#
# Configures environment variables used by the Stroom management
# scripts. E.g. ./start.sh

# These paths are relative to the file sourcing this one, e.g.
# relative to the location of start.sh, stop.sh, etc.

# shellcheck disable=SC2034
{
  APP_NAME="Stroom"

  # This is the default home for all stroom state on the filesystem
  # It should match appConfig.path.home in config.yml.
  # This should ideally be set to a location outside of the stroom
  # software deployment location so its lifecycle extends beyond a
  # single version.
  #STROOM_HOME="."

  # The log file for any output from the start script or stroom before
  # logging is initialised.
  # Relative to STROOM_HOME
  PATH_TO_START_LOG="logs/start.sh.log"

  # The log file produced by stroom's logging framework
  # Relative to STROOM_HOME
  # Should match the corresponding location in config.yml
  PATH_TO_APP_LOG="logs/app/app.log"

  # The log file for output from the migrate.sh script
  # Relative to STROOM_HOME
  PATH_TO_MIGRATE_LOG="logs/migration/migrate.sh.log"

  # The log file produced by stroom's logging framework for the migration SQL
  # Relative to STROOM_HOME
  # Should match the corresponding location in config.yml
  PATH_TO_MIGRATION_LOG="logs/migration/migration.log"

  # The jar file for the stroom application
  # Relative to the directory containing the start/stop scripts
  PATH_TO_JAR="bin/stroom-app-all.jar"

  # Relative to the directory containing the start/stop scripts
  PATH_TO_UTIL_SCRIPT="bin/utils.sh"

  # File to hold the process ID of the running stroom application
  # Relative to STROOM_HOME
  STROOM_PID_FILE="stroom.pid"

  # Dropwizard yaml config
  # Relative to the directory containing the start/stop scripts
  PATH_TO_CONFIG="config/config.yml"

  # Directory for java to write heap dumps to during out of memory events
  # Trailing slash important else it will be assumed to be a file
  # Relative to STROOM_HOME
  HEAP_DUMP_DIR="heap_dumps/"

  # This must match the admin port in config.yml
  # It is used to query the stroom health checks endpoint.
  ADMIN_PORT=8081
  # This must match the admin path in config.yml
  # It is used to query the stroom health checks endpoint.
  ADMIN_PATH=stroomAdmin

  # Additional options to pass to the JVM when running stroom, e.g. heap size
  # settings. HeapDumpOnOutOfMemoryError and HeapDumpPath will be 
  # set in start.sh if not set here.
  # Xms: The initial java heap size
  # Xmx: The maximum java heap size. This should be less than the available RAM.
  JAVA_OPTS="-Xms512m -Xmx2048m"
}
