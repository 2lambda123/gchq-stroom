before "test of inner \" strings " after
=====
<BRACKET_GROUP>
   <PIPE_GROUP>
      <STRING>before</STRING>
      <WHITESPACE></WHITESPACE>
      <DOUBLE_QUOTED_STRING>"test of inner \" strings "</DOUBLE_QUOTED_STRING>
      <WHITESPACE></WHITESPACE>
      <STRING>after</STRING>
   </PIPE_GROUP>
</BRACKET_GROUP>


"test of inner \" strings " after
=====
<BRACKET_GROUP>
   <PIPE_GROUP>
      <DOUBLE_QUOTED_STRING>"test of inner \" strings "</DOUBLE_QUOTED_STRING>
      <WHITESPACE></WHITESPACE>
      <STRING>after</STRING>
   </PIPE_GROUP>
</BRACKET_GROUP>


 "test of inner \" strings " after
=====
<BRACKET_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <DOUBLE_QUOTED_STRING>"test of inner \" strings "</DOUBLE_QUOTED_STRING>
      <WHITESPACE></WHITESPACE>
      <STRING>after</STRING>
   </PIPE_GROUP>
</BRACKET_GROUP>


before "test of inner \" strings "
=====
<BRACKET_GROUP>
   <PIPE_GROUP>
      <STRING>before</STRING>
      <WHITESPACE></WHITESPACE>
      <DOUBLE_QUOTED_STRING>"test of inner \" strings "</DOUBLE_QUOTED_STRING>
   </PIPE_GROUP>
</BRACKET_GROUP>


before "test of inner \" strings "
=====
<BRACKET_GROUP>
   <PIPE_GROUP>
      <STRING>before</STRING>
      <WHITESPACE></WHITESPACE>
      <DOUBLE_QUOTED_STRING>"test of inner \" strings "</DOUBLE_QUOTED_STRING>
   </PIPE_GROUP>
</BRACKET_GROUP>


before 'test of inner \' strings ' after
=====
<BRACKET_GROUP>
   <PIPE_GROUP>
      <STRING>before</STRING>
      <WHITESPACE></WHITESPACE>
      <SINGLE_QUOTED_STRING>'test of inner \' strings '</SINGLE_QUOTED_STRING>
      <WHITESPACE></WHITESPACE>
      <STRING>after</STRING>
   </PIPE_GROUP>
</BRACKET_GROUP>


'test of inner \' strings ' after
=====
<BRACKET_GROUP>
   <PIPE_GROUP>
      <SINGLE_QUOTED_STRING>'test of inner \' strings '</SINGLE_QUOTED_STRING>
      <WHITESPACE></WHITESPACE>
      <STRING>after</STRING>
   </PIPE_GROUP>
</BRACKET_GROUP>


 'test of inner \' strings ' after
=====
<BRACKET_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <SINGLE_QUOTED_STRING>'test of inner \' strings '</SINGLE_QUOTED_STRING>
      <WHITESPACE></WHITESPACE>
      <STRING>after</STRING>
   </PIPE_GROUP>
</BRACKET_GROUP>


before 'test of inner \' strings '
=====
<BRACKET_GROUP>
   <PIPE_GROUP>
      <STRING>before</STRING>
      <WHITESPACE></WHITESPACE>
      <SINGLE_QUOTED_STRING>'test of inner \' strings '</SINGLE_QUOTED_STRING>
   </PIPE_GROUP>
</BRACKET_GROUP>


before 'test of inner \' strings '
=====
<BRACKET_GROUP>
   <PIPE_GROUP>
      <STRING>before</STRING>
      <WHITESPACE></WHITESPACE>
      <SINGLE_QUOTED_STRING>'test of inner \' strings '</SINGLE_QUOTED_STRING>
   </PIPE_GROUP>
</BRACKET_GROUP>


table | where this = that | and foo = 'test of inner \' strings '
=====
<BRACKET_GROUP>
   <PIPE_GROUP>
      <STRING>table</STRING>
      <WHITESPACE></WHITESPACE>
   </PIPE_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <WHERE>where</WHERE>
      <WHITESPACE></WHITESPACE>
      <STRING>this</STRING>
      <WHITESPACE></WHITESPACE>
      <EQUALS>=</EQUALS>
      <WHITESPACE></WHITESPACE>
      <STRING>that</STRING>
      <WHITESPACE></WHITESPACE>
   </PIPE_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <AND>and</AND>
      <WHITESPACE></WHITESPACE>
      <STRING>foo</STRING>
      <WHITESPACE></WHITESPACE>
      <EQUALS>=</EQUALS>
      <WHITESPACE></WHITESPACE>
      <SINGLE_QUOTED_STRING>'test of inner \' strings '</SINGLE_QUOTED_STRING>
   </PIPE_GROUP>
</BRACKET_GROUP>


Test Index
| where UserId = user5 and Description = e0567
| and EventTime <= 2000-01-01T00:00:00.000Z
| and EventTime >= 2016-01-02T00:00:00.000Z
=====
<BRACKET_GROUP>
   <PIPE_GROUP>
      <STRING>Test Index</STRING>
      <WHITESPACE></WHITESPACE>
   </PIPE_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <WHERE>where</WHERE>
      <WHITESPACE></WHITESPACE>
      <STRING>UserId</STRING>
      <WHITESPACE></WHITESPACE>
      <EQUALS>=</EQUALS>
      <WHITESPACE></WHITESPACE>
      <STRING>user5</STRING>
      <WHITESPACE></WHITESPACE>
      <AND>and</AND>
      <WHITESPACE></WHITESPACE>
      <STRING>Description</STRING>
      <WHITESPACE></WHITESPACE>
      <EQUALS>=</EQUALS>
      <WHITESPACE></WHITESPACE>
      <STRING>e0567</STRING>
      <WHITESPACE></WHITESPACE>
   </PIPE_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <AND>and</AND>
      <WHITESPACE></WHITESPACE>
      <STRING>EventTime</STRING>
      <WHITESPACE></WHITESPACE>
      <LESS_THAN_OR_EQUAL_TO><=</LESS_THAN_OR_EQUAL_TO>
      <WHITESPACE></WHITESPACE>
      <STRING>2000-01-01T00:00:00.000Z</STRING>
      <WHITESPACE></WHITESPACE>
   </PIPE_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <AND>and</AND>
      <WHITESPACE></WHITESPACE>
      <STRING>EventTime</STRING>
      <WHITESPACE></WHITESPACE>
      <GREATER_THAN_OR_EQUAL_TO>>=</GREATER_THAN_OR_EQUAL_TO>
      <WHITESPACE></WHITESPACE>
      <STRING>2016-01-02T00:00:00.000Z</STRING>
   </PIPE_GROUP>
</BRACKET_GROUP>


Test Index
| where UserId = user5 and Description = e0567
| and EventTime <= now()
=====
<BRACKET_GROUP>
   <PIPE_GROUP>
      <STRING>Test Index</STRING>
      <WHITESPACE></WHITESPACE>
   </PIPE_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <WHERE>where</WHERE>
      <WHITESPACE></WHITESPACE>
      <STRING>UserId</STRING>
      <WHITESPACE></WHITESPACE>
      <EQUALS>=</EQUALS>
      <WHITESPACE></WHITESPACE>
      <STRING>user5</STRING>
      <WHITESPACE></WHITESPACE>
      <AND>and</AND>
      <WHITESPACE></WHITESPACE>
      <STRING>Description</STRING>
      <WHITESPACE></WHITESPACE>
      <EQUALS>=</EQUALS>
      <WHITESPACE></WHITESPACE>
      <STRING>e0567</STRING>
      <WHITESPACE></WHITESPACE>
   </PIPE_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <AND>and</AND>
      <WHITESPACE></WHITESPACE>
      <STRING>EventTime</STRING>
      <WHITESPACE></WHITESPACE>
      <LESS_THAN_OR_EQUAL_TO><=</LESS_THAN_OR_EQUAL_TO>
      <WHITESPACE></WHITESPACE>
      <FUNCTION>now</FUNCTION>
      <BRACKET_GROUP>
      </BRACKET_GROUP>
   </PIPE_GROUP>
</BRACKET_GROUP>


Test Index
| where UserId = user5 and Description = e0567
| and EventTime <= now() + 3d
=====
<BRACKET_GROUP>
   <PIPE_GROUP>
      <STRING>Test Index</STRING>
      <WHITESPACE></WHITESPACE>
   </PIPE_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <WHERE>where</WHERE>
      <WHITESPACE></WHITESPACE>
      <STRING>UserId</STRING>
      <WHITESPACE></WHITESPACE>
      <EQUALS>=</EQUALS>
      <WHITESPACE></WHITESPACE>
      <STRING>user5</STRING>
      <WHITESPACE></WHITESPACE>
      <AND>and</AND>
      <WHITESPACE></WHITESPACE>
      <STRING>Description</STRING>
      <WHITESPACE></WHITESPACE>
      <EQUALS>=</EQUALS>
      <WHITESPACE></WHITESPACE>
      <STRING>e0567</STRING>
      <WHITESPACE></WHITESPACE>
   </PIPE_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <AND>and</AND>
      <WHITESPACE></WHITESPACE>
      <STRING>EventTime</STRING>
      <WHITESPACE></WHITESPACE>
      <LESS_THAN_OR_EQUAL_TO><=</LESS_THAN_OR_EQUAL_TO>
      <WHITESPACE></WHITESPACE>
      <FUNCTION>now</FUNCTION>
      <BRACKET_GROUP>
      </BRACKET_GROUP>
      <WHITESPACE></WHITESPACE>
      <PLUS>+</PLUS>
      <WHITESPACE></WHITESPACE>
      <STRING>3d</STRING>
   </PIPE_GROUP>
</BRACKET_GROUP>


Test Index
| where UserId = user5 and Description = e0567
| and EventTime <= now() + 3
=====
<BRACKET_GROUP>
   <PIPE_GROUP>
      <STRING>Test Index</STRING>
      <WHITESPACE></WHITESPACE>
   </PIPE_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <WHERE>where</WHERE>
      <WHITESPACE></WHITESPACE>
      <STRING>UserId</STRING>
      <WHITESPACE></WHITESPACE>
      <EQUALS>=</EQUALS>
      <WHITESPACE></WHITESPACE>
      <STRING>user5</STRING>
      <WHITESPACE></WHITESPACE>
      <AND>and</AND>
      <WHITESPACE></WHITESPACE>
      <STRING>Description</STRING>
      <WHITESPACE></WHITESPACE>
      <EQUALS>=</EQUALS>
      <WHITESPACE></WHITESPACE>
      <STRING>e0567</STRING>
      <WHITESPACE></WHITESPACE>
   </PIPE_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <AND>and</AND>
      <WHITESPACE></WHITESPACE>
      <STRING>EventTime</STRING>
      <WHITESPACE></WHITESPACE>
      <LESS_THAN_OR_EQUAL_TO><=</LESS_THAN_OR_EQUAL_TO>
      <WHITESPACE></WHITESPACE>
      <FUNCTION>now</FUNCTION>
      <BRACKET_GROUP>
      </BRACKET_GROUP>
      <WHITESPACE></WHITESPACE>
      <PLUS>+</PLUS>
      <WHITESPACE></WHITESPACE>
      <NUMBER>3</NUMBER>
   </PIPE_GROUP>
</BRACKET_GROUP>


Events
| where Name = "Start"
| project City, ClientIp, StartTime = timestamp
| join  kind=inner
    (Events
    | where Name = "Stop"
    | project StopTime = timestamp, ClientIp)
    on ClientIp
| extend duration = StopTime - StartTime
    // Remove matches with earlier stops:
| where  duration > 0
    // Pick out the earliest stop for each start and client:
| summarize arg_min(duration, *) by bin(StartTime,1s), ClientIp
=====
<BRACKET_GROUP>
   <PIPE_GROUP>
      <STRING>Events</STRING>
      <WHITESPACE></WHITESPACE>
   </PIPE_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <WHERE>where</WHERE>
      <WHITESPACE></WHITESPACE>
      <STRING>Name</STRING>
      <WHITESPACE></WHITESPACE>
      <EQUALS>=</EQUALS>
      <WHITESPACE></WHITESPACE>
      <DOUBLE_QUOTED_STRING>"Start"</DOUBLE_QUOTED_STRING>
      <WHITESPACE></WHITESPACE>
   </PIPE_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <STRING>project City</STRING>
      <COMMA>,</COMMA>
      <WHITESPACE></WHITESPACE>
      <STRING>ClientIp</STRING>
      <COMMA>,</COMMA>
      <WHITESPACE></WHITESPACE>
      <STRING>StartTime</STRING>
      <WHITESPACE></WHITESPACE>
      <EQUALS>=</EQUALS>
      <WHITESPACE></WHITESPACE>
      <STRING>timestamp</STRING>
      <WHITESPACE></WHITESPACE>
   </PIPE_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <STRING>join  kind=</STRING>
      <FUNCTION>inner</FUNCTION>
      <WHITESPACE></WHITESPACE>
      <BRACKET_GROUP>
         <PIPE_GROUP>
            <STRING>Events</STRING>
            <WHITESPACE></WHITESPACE>
         </PIPE_GROUP>
         <PIPE_GROUP>
            <WHITESPACE></WHITESPACE>
            <WHERE>where</WHERE>
            <WHITESPACE></WHITESPACE>
            <STRING>Name</STRING>
            <WHITESPACE></WHITESPACE>
            <EQUALS>=</EQUALS>
            <WHITESPACE></WHITESPACE>
            <DOUBLE_QUOTED_STRING>"Stop"</DOUBLE_QUOTED_STRING>
            <WHITESPACE></WHITESPACE>
         </PIPE_GROUP>
         <PIPE_GROUP>
            <WHITESPACE></WHITESPACE>
            <STRING>project StopTime</STRING>
            <WHITESPACE></WHITESPACE>
            <EQUALS>=</EQUALS>
            <WHITESPACE></WHITESPACE>
            <STRING>timestamp</STRING>
            <COMMA>,</COMMA>
            <WHITESPACE></WHITESPACE>
            <STRING>ClientIp</STRING>
         </PIPE_GROUP>
      </BRACKET_GROUP>
      <WHITESPACE></WHITESPACE>
      <STRING>on ClientIp</STRING>
      <WHITESPACE></WHITESPACE>
   </PIPE_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <STRING>extend duration</STRING>
      <WHITESPACE></WHITESPACE>
      <EQUALS>=</EQUALS>
      <WHITESPACE></WHITESPACE>
      <STRING>StopTime</STRING>
      <WHITESPACE></WHITESPACE>
      <MINUS>-</MINUS>
      <WHITESPACE></WHITESPACE>
      <STRING>StartTime</STRING>
      <WHITESPACE></WHITESPACE>
      <COMMENT>// Remove matches with earlier stops:</COMMENT>
      <WHITESPACE></WHITESPACE>
   </PIPE_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <WHERE>where</WHERE>
      <WHITESPACE></WHITESPACE>
      <STRING>duration</STRING>
      <WHITESPACE></WHITESPACE>
      <GREATER_THAN>></GREATER_THAN>
      <WHITESPACE></WHITESPACE>
      <NUMBER>0</NUMBER>
      <WHITESPACE></WHITESPACE>
      <COMMENT>// Pick out the earliest stop for each start and client:</COMMENT>
      <WHITESPACE></WHITESPACE>
   </PIPE_GROUP>
   <PIPE_GROUP>
      <WHITESPACE></WHITESPACE>
      <STRING>summarize arg_</STRING>
      <FUNCTION>min</FUNCTION>
      <BRACKET_GROUP>
         <PIPE_GROUP>
            <STRING>duration</STRING>
            <COMMA>,</COMMA>
            <WHITESPACE></WHITESPACE>
            <MULTIPLICATION>*</MULTIPLICATION>
         </PIPE_GROUP>
      </BRACKET_GROUP>
      <WHITESPACE></WHITESPACE>
      <BY>by</BY>
      <WHITESPACE></WHITESPACE>
      <FUNCTION>bin</FUNCTION>
      <BRACKET_GROUP>
         <PIPE_GROUP>
            <STRING>StartTime</STRING>
            <COMMA>,</COMMA>
            <STRING>1s</STRING>
         </PIPE_GROUP>
      </BRACKET_GROUP>
      <COMMA>,</COMMA>
      <WHITESPACE></WHITESPACE>
      <STRING>ClientIp</STRING>
   </PIPE_GROUP>
</BRACKET_GROUP>


